###############################################################################
# SERVICES.CFG - SERVCE OBJECTS
###############################################################################

define service {
  use                 generic-service
  host_name           *
  service_description PING
  check_command       check_ping!100.0,20%!500.0,60%
}

define service {
  use                 generic-service
  host_name           <%= nagios_service_hosts(@hosts, "ZOMBIES") %>
  service_description ZOMBIES
  check_command       check_nrpe!check_zombie_procs
}

define service {
  use                 generic-service
  host_name           <%= nagios_service_hosts(@hosts, "PROCS") %>
  service_description PROCS
  check_command       check_nrpe!check_total_procs
}

define service {
  use                 generic-service
  host_name           <%= nagios_service_hosts(@hosts, "DISKS") %>
  service_description DISKS
  check_command       check_nrpe!check_disks
}

define service {
  use                 generic-service
  host_name           <%= nagios_service_hosts(@hosts, "LOAD") %>
  service_description LOAD
  check_command       check_nrpe!check_load
}

define service {
  use                 generic-service
  host_name           <%= nagios_service_hosts(@hosts, "SWAP") %>
  service_description SWAP
  check_command       check_nrpe!check_swap
}

define service {
  use                 generic-service
  host_name           <%= nagios_service_hosts(@hosts, "CRON") %>
  service_description CRON
  check_command       check_nrpe!check_cron
}

define service {
  use                 generic-service
  host_name           <%= nagios_service_hosts(@hosts, "SWRAID") %>
  service_description SWRAID
  check_command       check_nrpe!check_swraid
}

define service {
  use                 generic-service
  host_name           <%= nagios_service_hosts(@hosts, "SSH") %>
  service_description SSH
  check_command       check_ssh!22
}

define service {
  use                 generic-service
  host_name           <%= nagios_service_hosts(@hosts, "TIME") %>
  service_description TIME
  check_command       check_nrpe!check_ntp_time
}

<% @mysql_nodes.each do |n| %>
##
## MySQL checks for <%= n[:fqdn] %>
##

<% n[:mysql][:nagios].each do |name, params| %>
<% if params[:enabled] %>
define service {
  use                 generic-service
  host_name           <%= n[:fqdn] %>
  service_description MYSQL-<%= name.to_s.upcase %>
  check_command       check_nrpe!check_mysql_<%= name.to_s %>
  normal_check_interval <%= params[:normal_check_interval] %>
  notification_interval <%= params[:notification_interval] %>
  <% if params[:silent] %>
  notification_period never
  <% end %>
}

<% end %>
<% end %>
<% end %>
